# 第19章 二项式期权定价

## 19.1 一个风险中性的世界

* 考虑一个单步二叉树
  * 父节点S：现价
  * 子节点Su、Sd：向上价格、向下价格（u、d为乘数）
  * 概率p、1-p：向上向下的概率
* 若风险中性
  * $pSu+(1-p)Sd=S\rightarrow p=\frac{1-d}{u-d}$
  * 对于不分红的远期股票 $p=\frac{(1+rt)-d}{u-d}$

## 19.2 期权估值

* call的期望价值
  * $p\times\max{[Su-X,0]}+(1-p)\times\max{[Sd-X,0]}$
  * 理论价值=期望价值/（1+rt）
* put的期望价值
  * $p\times\max{[X-Su,0]}+(1-p)\times\max{[X-Sd,0]}$
  * 理论价值=期望价值/（1+rt）
* 任意步数的二叉树
  * n=步数
  * t=到期时间/年
  * r=年利率
  * ud=1
  * 最终标的价可能为 $Su^jd^{n-j}, j=0,1,2,\dots,n$
  * 每种标的价的路径数量为 $\frac{n!}{j!(n-j)!}$
  * 欧式期权价值
    * call: $\frac{1}{(1+rt/n)^n}\sum_{j=0}^n\frac{n!}{j!(n-j)!}\times p^j(1-p)^{n-j}\times\max{[Su^jd^{n-j}-X,0]}$
    * put: $\frac{1}{(1+rt/n)^n}\sum_{j=0}^n\frac{n!}{j!(n-j)!}\times p^j(1-p)^{n-j}\times\max{[X-Su^jd^{n-j},0]}$
    * 理论上符合看涨-看跌平价关系 $C-P=\frac{F-X}{1+rt}$

### 19.2.1 一个三步的例子

略

### 19.2.2 二项式符号

* S/P/C下标
  * i：层数
  * j：从低价到高价的序号
* 父子节点关系
  * $C_{i,j}=\frac{pC_{i+1,j+1}+(1-p)C_{i+1,j}}{1+rt/n}$
  * 可以从最终价值反向推导中间节点的价值

## 19.3 Delta

* $\Delta_{i,j}=\frac{C_{i+1,j+1}-C_{i+1,j}}{S_{i+1,j+1}-S_{i+1,j}}(\times100)$

## 19.4 Gamma

* $\Gamma_{i,j}=\frac{\Delta_{i+1,j+1}-\Delta_{i+1,j}}{S_{i+1,j+1}-S_{i+1,j}}$

## 19.5 Theta

* $\frac{C_{i,j}-C_{i+2,j+1}}{t\times365/n}$

## 19.6 Vega和Rho

* 没有简单的算术方法

## 19.7 u值和d值

* ud=1是为了消除漂移
* u、d应使最终价格近似于对数正态分布
  * $u=\exp(\sigma\sqrt{t/n})$
  * $d=\exp(-\sigma\sqrt{t/n})$

## 19.8 Gamma值的租赁

* 交易者有时将波动率交易看作对Gamma值的租赁，租赁成本=Theta

## 19.9 美式期权

* 对于欧式期权，计算中间节点的目的仅在于确定Delta、Gamma
* 对于美式期权
  * 在每个节点都比较欧式期权的价值与内在价值
  * 若内在价值>欧式期权价值，用内在价值代替价值，反向求解父节点期权价值
  * Delta、Gamma要重新计算

## 19.10 股息

* 派息是美式期权的关键——不派息则无提前行权之必要
* 最终价格使用派息后价格，并反推
* 对于欧式期权，步数越多，则越逼近于B-S模型